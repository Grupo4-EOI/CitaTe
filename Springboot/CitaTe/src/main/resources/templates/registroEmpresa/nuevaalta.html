<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Multi Step Registro</title>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


    <link rel="stylesheet" href="/webjars/bootstrap/css/bootstrap.min.css" />
    <link href="/webjars/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/CitaTe.css}">
    <link th:href="@{/nuevoestilo.css}" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>
        function checkAltaCliente() {
            document.getElementById("myCheckaltacliente").checked = true;
            document.getElementById("myCheckaltaempleado").checked = false;
            document.getElementById("myCheckaltaempresa").checked = false;
            ul = document.getElementById("signup-step")
            ul.innerHTML = ""
            var entry = document.createElement('li');
            entry.id = "usuario"
            entry.className = "active"
            entry.textContent = "Datos del usuario"
            ul.appendChild(entry)
            var entrysec = document.createElement('li');
            entrysec.id = "cliente"
            entrysec.textContent = "Cliente"
            ul.appendChild(entrysec)
            document.getElementById("tipoalta").value = "cliente"

        }


        function checkAltaEmpleado() {
            document.getElementById("myCheckaltacliente").checked = false;
            document.getElementById("myCheckaltaempleado").checked = true;
            document.getElementById("myCheckaltaempresa").checked = false;
            ul = document.getElementById("signup-step")
            ul.innerHTML = ""
            var entry = document.createElement('li');
            entry.id = "usuario"
            entry.className = "active"
            entry.textContent = "Datos del usuario"
            ul.appendChild(entry)
            var entrysec = document.createElement('li');
            entrysec.id = "empleado"
            entrysec.textContent = "Empleado"
            ul.appendChild(entrysec)
            document.getElementById("tipoalta").value = "empleado"
        }


        function checkAltaEmpresa() {
            document.getElementById("myCheckaltacliente").checked = false;
            document.getElementById("myCheckaltaempleado").checked = false;
            document.getElementById("myCheckaltaempresa").checked = true;
            ul = document.getElementById("signup-step")
            ul.innerHTML = ""

            var entry = document.createElement('li');
            entry.id = "usuario"
            entry.className = "active"
            entry.textContent = "Datos del usuario"
            ul.appendChild(entry)


            var entrysec = document.createElement('li');
            entrysec.id = "empleado"
            entrysec.textContent = "Empleado"
            ul.appendChild(entrysec)

            var entrysec1 = document.createElement('li');
            entrysec1.id = "empresa"
            entrysec1.textContent = "Empresa"
            ul.appendChild(entrysec1)


            var entrysec2 = document.createElement('li');
            entrysec2.id = "empresa2"
            entrysec2.textContent = "Empresa 2"
            ul.appendChild(entrysec2)

            var entrysec3 = document.createElement('li');
            entrysec3.id = "empresa3"
            entrysec3.textContent = "Empresa 3"
            ul.appendChild(entrysec3)

            var entrysec4 = document.createElement('li');
            entrysec4.id = "empresa4"
            entrysec4.textContent = "Empresa 4"
            ul.appendChild(entrysec4)

            var entrysec5 = document.createElement('li');
            entrysec5.id = "empresa5"
            entrysec5.textContent = "Empresa 5"
            ul.appendChild(entrysec5)

            var entrysec6 = document.createElement('li');
            entrysec6.id = "empresa6"
            entrysec6.textContent = "Empresa 6"
            ul.appendChild(entrysec6)

            var entrysec7 = document.createElement('li');
            entrysec7.id = "empresa7"
            entrysec7.textContent = "Empresa 7"
            ul.appendChild(entrysec7)

            var entrysec8 = document.createElement('li');
            entrysec8.id = "empresa8"
            entrysec8.textContent = "Empresa 8"
            ul.appendChild(entrysec8)

            var entrysec9 = document.createElement('li');
            entrysec9.id = "empresa9"
            entrysec9.textContent = "Empresa 9"
            ul.appendChild(entrysec9)




            document.getElementById("tipoalta").value = "empresa"
        }


        function validate() {
            var output = true;
            $(".signup-error").html('');

            if ($("#usuario-field").css('display') != 'none') {
                if (!($("#email").val())) {
                    output = false;
                    $("#email-error").html("Name required!");
                }
                if (!($("#user-password").val())) {
                    output = false;
                    $("#password-error").html("Password required!");
                }

                if (!($("#confirm-password").val())) {
                    output = false;
                    $("#confirm-password-error").html("Confirm password required!");
                }

                if ($("#user-password").val() != $("#confirm-password").val()) {
                    output = false;
                    $("#confirm-password-error").html("Password not matched!");
                }
            }

            if ($("#cliente-field").css('display') != 'none') {
                if (!($("#telefono").val())) {
                    output = false;
                    $("#telefono-error").html("Telefono obligatorio!");
                }

                if (!($("#nombreCliente").val())) {
                    output = false;
                    $("#nombreCliente-error").html("nombreCliente obligatorio!");
                }
                if (!($("#apellido1Cliente").val())) {
                    output = false;
                    $("#apellido1Cliente-error").html("apellido1Cliente obligatorio!");
                }
                if (!($("#apellido2Cliente").val())) {
                    output = false;
                    $("#apellido2Cliente-error").html("apellido2Cliente obligatorio!");
                }
            }
            if ($("#empleado-field").css('display') != 'none') {
                if (!($("#nombreEmpleado").val())) {
                    output = false;
                    $("#nombreEmpleado-error").html("nombreEmpleado obligatorio!");
                }
                if (!($("#apellido1Empleado").val())) {
                    output = false;
                    $("#apellido1Empleado-error").html("apellido1Empleado obligatorio!");
                }
                if (!($("#apellido1Empleado").val())) {
                    output = false;
                    $("#apellido2Empleado-error").html("apellido1Empleado obligatorio!");
                }
            }
            if ($("#empleado-field").css('display') != 'none') {
                if (!($("#nombreEmpresa").val())) {
                    output = false;
                    $("#nombreEmpresa-error").html("nombreEmpresa obligatorio!");
                }
                if (!($("#cif").val())) {
                    output = false;
                    $("#cif-error").html("cif obligatorio!");
                }

            }
            return output;
        }

        $(document).ready(function() {
            $("#next").click(function() {
                console.log("Siguiente pestaña" );
                var output = validate();
                if (output === true) {
                    var current = $(".active");
                    var next = $(".active").next("li");
                    if (next.length > 0) {
                        $("#" + current.attr("id") + "-field").hide();
                        console.log("Siguiente pestaña:" + next.attr("id") )
                        $("#" + next.attr("id") + "-field").show();
                        $("#back").show();
                        $("#finish").hide();
                        $(".active").removeClass("active");
                        next.addClass("active");
                        var ul    = document.getElementById("signup-step");
                        var last = ul.lastElementChild;
                        console.log("Active id:" + $(".active").attr("id"));
                        console.log("last id:" + last.getAttribute("id"));
                        if ($(".active").attr("id") == last.getAttribute("id")) {
                            $("#next").hide();
                            $("#finish").show();
                        }
                    }
                }
            });

            $("#back").click(function() {
                var current = $(".active");
                var prev = $(".active").prev("li");
                if (prev.length > 0) {
                    $("#" + current.attr("id") + "-field").hide();
                    $("#" + prev.attr("id") + "-field").show();
                    $("#next").show();
                    $("#finish").hide();
                    $(".active").removeClass("active");
                    prev.addClass("active");
                    if ($(".active").attr("id") == $("li").first().attr("id")) {
                        $("#back").hide();
                    }
                }
            });

            $("input#finish").click(function(e) {
                var output = validate();
                var current = $(".active");

                if (output === true) {
                    return true;
                } else {
                    //prevent refresh
                    e.preventDefault();
                    $("#" + current.attr("id") + "-field").show();
                    $("#back").show();
                    $("#finish").show();
                }
            });
        });
    </script>







</head>
<body>

<!--Header-->

<div th:replace="~{fragmentos/headerRegistroEmpresa :: header}"></div>


<div class="container" style="min-height: 50%">

    <div>
        <label for ="myCheckaltacliente">Alta cliente</label>
        <input type="checkbox" id="myCheckaltacliente" th:checked="true">
        <label for ="myCheckaltaempleado">Alta empleado</label>
        <input type="checkbox" id="myCheckaltaempleado" th:checked="false">
        <label for ="myCheckaltaempleado">Alta empresa</label>
        <input type="checkbox" id="myCheckaltaempresa" th:checked="false">
    </div>
    <div>
        <button id = "altacliente" onclick="checkAltaCliente()">Alta usuario</button>
        <button id = "altaEmpleado" onclick="checkAltaEmpleado()">Alta empleado</button>
        <button id = "altaEmpresa" onclick="checkAltaEmpresa()">Alta empresa</button>

    </div>
    <ul id="signup-step">
        <li id="usuario" class="active">Datos del usuario</li>
        <li id="cliente">Cliente</li>
    </ul>


    <form name="frmRegistration" id="signup-form" th:action="/"  th:object="${datos}" method="post" th:method="POST">
        <input type="hidden" name="tipoalta" id="tipoalta" th:field="*{tipoalta}"  />

        <div id="usuario-field">
            <label for="email">email</label><span id="email-error" class="signup-error"></span>
            <div>
                <input type="text" name="email" id="email" th:field="*{usuario.email}" class="demoInputBox" />
            </div>
            <label>Enter Password</label><span id="password-error"
                                               class="signup-error"></span>
            <div>
                <input type="password" name="password" th:field="*{usuario.pass}" id="user-password"
                       class="demoInputBox" />
            </div>
            <label>Re-enter Password</label><span id="confirm-password-error"
                                                  class="signup-error"></span>
            <div>
                <input type="password" name="confirm-password" id="confirm-password"
                       class="demoInputBox" />
            </div>
        </div>


        <div id="cliente-field" style="display: none;">
            <label for = "nombreCliente">Nombre</label><span id="nombreCliente-error" class="signup-error"></span>
            <div>
                <input type="text" name="nombreCliente" id ="nombreCliente" th:field="*{cliente.nombreCliente}" class="demoInputBox" />
            </div>
            <label for = "apellido1Cliente">apellido1Cliente</label><span id="apellido1Cliente-error" class="signup-error"></span>
            <div>
                <input type="text" name="apellido1Cliente" id ="apellido1Cliente" th:field="*{cliente.apellido1Cliente}" class="demoInputBox" />
            </div>
            <label for = "apellido2Cliente">apellido2Cliente</label><span id="apellido2Cliente-error" class="signup-error"></span>
            <div>
                <input type="text" name="apellido2Cliente" id ="apellido2Cliente" th:field="*{cliente.apellido2Cliente}" class="demoInputBox" />
            </div>
            <label for = "telefono">telefono</label><span id="telefono-error" class="telefono-error"></span>
            <div>
                <input type="text" name="telefono" id ="telefono" th:field="*{cliente.telefono}" class="demoInputBox" />
            </div>

            <!--            <input class="btnAction" type="submit" name="finish" id="finishCliente"-->
            <!--                   value="Finish" style="display: none;">-->

        </div>

        <div id="empleado-field" style="display: none;">
            <label for = "nombreEmpleado">nombreEmpleado</label><span id="nombreEmpleado-error" class="signup-error"></span>
            <div>
                <input type="text" name="nombreEmpleado" id ="nombreEmpleado" th:field="*{empleado.nombreEmpleado}" class="demoInputBox" />
            </div>
            <label for = "apellido1Empleado">apellido 1 Empleado</label><span id="apellido1Empleado-error" class="signup-error"></span>
            <div>
                <input type="text" name="apellido1Empleado" id ="apellido1Empleado" th:field="*{empleado.apellido1Empleado}" class="demoInputBox" />
            </div>
            <label for = "apellido2Empleado">apellido 2 Empleado</label><span id="apellido2Empleado-error" class="signup-error"></span>
            <div>
                <input type="text" name="apellido2Empleado" id ="apellido2Empleado" th:field="*{empleado.apellido2Empleado}" class="demoInputBox" />
            </div>
            <!-- ¿Como seleccionar elementos de una lista con thymeleaf-->
            <!--div class="d-flex flex-row align-items-center mb-4">
                <label for="etiqueta1"  class="form-label mt-2 mb-1">Etiqueta 1</label>
                <select th:field="*{etiquetas}" class="form-control"  id="etiqueta1">
                    <option value="" th:disabled="disabled" th:selected="selected">
                        Selecciona un elemento
                    </option>
                    <th:block th:each="etiq1: ${listaEtiquetas}">
                        <option th:value="${etiq1.id}" th:text="${etiq1.name}"></option>
                    </th:block>
                </select>
            </div-->
        </div>

        <div id="empresa-field" style="display: none;">

            <label for = "nombreEmpresa">nombreEmpresa</label><span id="nombreEmpresa-error" class="signup-error"></span>
            <div>
                <input type="text" name="nombreEmpresanombreEmpleado" id ="nombreEmpresa" th:field="*{empresa.nombreEmpresa}" class="demoInputBox" />
            </div>

            <label for = "cif">cif</label><span id="cif-error" class="signup-error"></span>
            <div>
                <input type="text" name="cif" id ="cif" th:field="*{empresa.cif}" class="demoInputBox" />
            </div>
        </div>






        <div>
            <input class="btnAction" type="button" name="back" id="back"
                   value="Back" style="display: none;">
            <input
                class="btnAction" type="button" name="next" id="next" value="Next">
            <input class="btnAction" type="submit" name="finish" id="finish"
                   th:formaction="'/usuarios/create/nuevaalta'"
                   value="Finish" style="display: none;">
        </div>

    </form>
</div>
<!--Fooooterrrrr-->

<div th:replace="~{fragmentos/footer1 :: footer}"></div>

<!--Fooooterrrrr-->


<script src="/webjars/bootstrap/js/bootstrap.min.js"></script>
</body>
</html>